deliverable 2:

-query 7:
SELECT AVG(L1.PRICE)-AVG(L2.PRICE) AS DIFF_AVG_WITH_AND_WITHOUT_WIFI
FROM LISTINGS L1, LISTINGS L2, AMENITIES_AND_LISTINGS AAL, AMENITIES A
WHERE A.AMENITY='Wifi' AND A.AMENITY_ID=AAL.AMENITY_ID
  AND AAL.LISTING_ID=L1.LISTING_ID AND
  L2.LISTING_ID NOT IN (  SELECT AAL.LISTING_ID
                          FROM AMENITIES_AND_LISTINGS AAL, AMENITIES A
                          WHERE A.AMENITY='Wifi' AND A.AMENITY_ID=AAL.AMENITY_ID)

-query 8:
SELECT  AVG(L1.PRICE)-AVG(L2.PRICE) AS DIFF_AVG_8BEDS_BER_MAD
FROM LISTINGS L1, LISTINGS L2, NEIGH N1, CITIES C1, NEIGH N2, CITIES C2
WHERE L1.BEDS=8 AND L2.BEDS=8 AND
  L1.NEIGH_ID=N1.NEIGH_ID AND N1.CITY_ID=C1.CITY_ID AND C1.CITY='berlin' AND
  L2.NEIGH_ID=N2.NEIGH_ID AND N2.CITY_ID=C2.CITY_ID AND C2.CITY='madrid'


_____________________________________________________________________________
deliverable 3:

-query 2:
SELECT DISTINCT PERCENTILE_DISC(0.5) WITHIN GROUP(ORDER BY L.REVIEW_SCORES_RATING) OVER (PARTITION BY L.NEIGH_ID) AS MEDIAN, L.NEIGH_ID
FROM LISTINGS L, NEIGH N, CITIES C
WHERE L.NEIGH_ID=N.NEIGH_ID AND N.CITY_ID=C.CITY_ID AND C.CITY='madrid'
ORDER BY MEDIAN DESC
FETCH FIRST 5 ROWS ONLY

-query 8:
SELECT AVG(L1.REVIEW_SCORES_COMMUNICATION)-AVG(L2.REVIEW_SCORES_COMMUNICATION)
FROM LISTINGS L1, (SELECT LIST_COUNT_MAX.HOST_ID
                  FROM (SELECT COUNT(*), HVAH.HOST_ID
                        FROM HOST_VERIF_AND_HOST HVAH
                        GROUP BY HVAH.HOST_ID
                        ORDER BY COUNT(*) DESC) LIST_COUNT_MAX
                  WHERE ROWNUM = 1) MAX_VERIF_HOST,
     LISTINGS L2, (SELECT LIST_COUNT_MIN.HOST_ID
                  FROM (SELECT COUNT(*), HVAH.HOST_ID
                        FROM HOST_VERIF_AND_HOST HVAH
                        GROUP BY HVAH.HOST_ID
                        ORDER BY COUNT(*)) LIST_COUNT_MIN
                  WHERE ROWNUM = 1) MIN_VERIF_HOST
WHERE L1.HOST_ID = MAX_VERIF_HOST.HOST_ID AND
      L2.HOST_ID = MIN_VERIF_HOST.HOST_ID

-query 11:
SELECT ALL_TAB.COUNTRY, AV_TAB.NUM_AVAIL_LIST_IN_2018/ALL_TAB.NUM_LIST_IN_2018 AS RATIO
FROM (  SELECT COUNT(DISTINCT L.LISTING_ID) AS NUM_LIST_IN_2018, CTRI.COUNTRY
        FROM CALENDAR C 
          JOIN LISTINGS L ON C.LISTING_ID=L.LISTING_ID
          JOIN NEIGH N ON L.NEIGH_ID=N.NEIGH_ID
          JOIN CITIES CIT ON N.CITY_ID=CIT.CITY_ID
          JOIN COUNTRIES CTRI ON CIT.COUNTRY_ID=CTRI.COUNTRY_ID
        WHERE C.DATE_CALENDAR BETWEEN '2018-01-01' AND '2018-12-31'
        GROUP BY CTRI.COUNTRY) ALL_TAB
        JOIN
    ( SELECT COUNT(DISTINCT L.LISTING_ID) AS NUM_AVAIL_LIST_IN_2018, CTRI.COUNTRY
      FROM CALENDAR C 
        JOIN LISTINGS L ON C.LISTING_ID=L.LISTING_ID
        JOIN NEIGH N ON L.NEIGH_ID=N.NEIGH_ID
        JOIN CITIES CIT ON N.CITY_ID=CIT.CITY_ID
        JOIN COUNTRIES CTRI ON CIT.COUNTRY_ID=CTRI.COUNTRY_ID
      WHERE C.DATE_CALENDAR BETWEEN '2018-01-01' AND '2018-12-31'
        AND C.AVAILABLE='t'
      GROUP BY CTRI.COUNTRY) AV_TAB ON ALL_TAB.COUNTRY=AV_TAB.COUNTRY
WHERE AV_TAB.NUM_AVAIL_LIST_IN_2018/ALL_TAB.NUM_LIST_IN_2018>=0.2;